see concurrency in action repozitory 

atomic_counter